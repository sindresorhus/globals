import fs from 'node:fs/promises';

const DATA_FILE = new URL('../globals.json', import.meta.url);

const globals = JSON.parse(await fs.readFile(DATA_FILE));

const getGroupTypeName = (group) => `Globals${group[0].toUpperCase() + group.slice(1).replaceAll('-', '')}`;

const groups = {};

console.log('// This file is autogenerated by scripts/generate-types.mjs');
console.log('// Do NOT modify this file manually\n');

for (const group in globals) {
	const groupType = getGroupTypeName(group);
	groups[group] = groupType;

	console.log(`interface ${getGroupTypeName(group)} {`);

	for (const [rule, status] of Object.entries(globals[group])) {
		console.log(`	readonly '${rule}': ${status};`);
	}

	console.log(`}\n`);
}

console.log(`export interface globals {`);

for (const [group, groupType] of Object.entries(groups)) {
	console.log(`	readonly '${group}': ${groupType};`);
}

console.log(`}`);
